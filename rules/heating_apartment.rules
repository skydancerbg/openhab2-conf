// HOME OFFICE HEATING RELATED:
rule "Update Heating STEFANS BEDROOM"

when
	Item AT_BR_Heating_Setpoint received update or 
	Item GF_Sonoff_TH16_2_Temperature received update or 
    Item Heating_AT_ON_OFF changed
then
            
            // logInfo("heating_current_temp", GF_Sonoff_TH16_6_Temperature.state.toString)
            // logInfo("heating_temp_minus_1", ((GF_OF_Heating_Setpoint.state as Number)-1.0).toString)
            // logInfo("heating_setpoint_temp", GF_OF_Heating_Setpoint.state.toString)


    if(((GF_Sonoff_TH16_2_Temperature.state as Number)< (AT_BR_Heating_Setpoint.state as Number)-0.5 ) && Heating_AT_ON_OFF.state == ON) {
        // logInfo("heating", GF_OF_sonoff_pow_2_Power.state.toString)
        // logInfo("heating", GF_OF_sonoff_pow_3_Power.state.toString)
		if(GF_Sonoff_TH16_2_Power.state == OFF) {
                    //  logInfo("heating", "komanda pow2 on")

            GF_Sonoff_TH16_2_Power.sendCommand(ON)
            AT_BR_Heating.sendCommand(ON)
        }
	}else if (((GF_Sonoff_TH16_2_Temperature.state as Number) >= (AT_BR_Heating_Setpoint.state as Number)-0.1) || Heating_AT_ON_OFF.state == OFF)
    {
        // logInfo("heating_temp_greater_than_set_point", "temperaturata e po-goliama")
		
         if(GF_Sonoff_TH16_2_Power.state == ON) {
                    // logInfo("heating", "komanda OFF")
            GF_Sonoff_TH16_2_Power.sendCommand(OFF)
            AT_BR_Heating.sendCommand(OFF)
        }
        // if(GF_Sonoff_TH16_2_Power.state == OFF) {
        //             // logInfo("heating", "komanda OFF")
        //     AT_BR_Heating.sendCommand(OFF)
        // }
      
    }
	// else {
	// 	if(GF_OF_sonoff_pow_2_Power.state = ON) GF_OF_sonoff_pow_2_Power.sendCommand(OFF)
	// }


end

rule "Heating ON/OFF stefans bedroom set to OFF"

when
	Item Heating_AT_ON_OFF received command OFF
then
    if( Heating_AT_ON_OFF.state == OFF) {
        // logInfo("heating", "testtttttttttt")

		if(GF_Sonoff_TH16_2_Power.state == ON) {
                    //  logInfo("heating", " POW2komanda OFF")
            GF_Sonoff_TH16_2_Power.sendCommand(OFF)
        }
    }
end